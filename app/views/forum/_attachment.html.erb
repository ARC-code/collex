<%
    # ------------------------------------------------------------------------
    # Copyright 2009 Applied Research in Patacriticism and the University of Virginia
    #
    # Licensed under the Apache License, Version 2.0 (the "License");
    # you may not use this file except in compliance with the License.
    # You may obtain a copy of the License at
    #
    #    http://www.apache.org/licenses/LICENSE-2.0
  
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.
    # ---------------------------------------------------------------------------- -%>
<% # attachment params: ActiveRecord comment -%>

<div class="FP_attachment">
	<% comment_info = get_comment_header_info(comment) -%>
	<% if comment_info[:link] -%>
		<% title = link_to(comment_info[:caption], comment_info[:link], :class => 'nav_link') -%>
	<% else -%>
		<% title = comment_info[:caption] -%>
	<% end -%>
	<% if comment_info[:thumbnail] -%>
		<%= render :partial => 'img_with_progress_spinner', :locals => { :src => comment_info[:thumbnail], :alt => 'thumbnail', :klass => "FP_attachment_img", :width => 100, :height => 125 } -%>
	<% end -%>
	<p class="FP_attachment_title"><%= title %></p>
	<% details_id = "nines_object_#{comment.id}" -%>
	<% details_id_show = "#{details_id}_show" -%>
	<% details_id_hide = "#{details_id}_hide" -%>
	<% if comment.get_type() == "nines_object" -%>
		<p><a id='<%= details_id_show %>' href="#" class='nav_link' onclick='$("<%= details_id %>").show(); $("<%= details_id_hide %>").show(); $("<%= details_id_show %>").hide(); return false;''>[Details]</a>
			<a id='<%= details_id_hide %>' style='display:none' href="#" class='nav_link' onclick='$("<%= details_id %>").hide(); $("<%= details_id_hide %>").hide(); $("<%= details_id_show %>").show(); return false;'>[Hide Details]</a></p>
		<div id='<%= details_id %>' class='nines_object_details' style='display:none' >
			<% hit = CachedResource.get_hit_from_resource_id(comment.cached_resource_id) -%>
			<%= render :partial => 'nines_object_details', :locals => { :hit => hit, :details_id => details_id } %>
		</div>
	<% end -%>
</div>		
