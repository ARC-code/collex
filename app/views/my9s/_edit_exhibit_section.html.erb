<% ajax_section_action = "'/my9s/edit_section'" -%>
<% ajax_section_div_id = "'edit_exhibit_page'" -%>
<% ajax_section_params = "'page=#{page.id}&section=#{section.position}&verb='" -%>
<!--<h1><%= link_to_function ins_char(), "doAjaxLink(#{ajax_section_div_id}, #{ajax_section_action}, #{ajax_section_params}+'insert');", { :title => 'Insert Section Before' } %>
	Section&nbsp;<%= section.position %>&nbsp;
	<%= link_to_function(up_char(), "doAjaxLink(#{ajax_section_div_id}, #{ajax_section_action}, #{ajax_section_params}+ 'up');", { :title => 'Move Section Up' }) if section.position > 1 %>
	<%= link_to_function(down_char(), "doAjaxLink(#{ajax_section_div_id}, #{ajax_section_action}, #{ajax_section_params}+ 'down');", { :title => 'Move Section Down' }) if (section.position <= page.exhibit_sections.length) %>
	<%= link_to_function del_char(), "doAjaxLink(#{ajax_section_div_id}, #{ajax_section_action}, #{ajax_section_params}+ 'delete');", { :title => 'Delete Section' } %>
	<% ajax_call_str = "#{ajax_section_div_id}, #{ajax_section_action}, #{ajax_section_params}+this.options[this.selectedIndex].value);" -%>
	<select onchange="doAjaxLink(<%= ajax_call_str %>">
	<option <%= "selected='selected'" if section.has_border == 1 %> value="add_border">Border</option>
	<option <%= "selected='selected'" if section.has_border == 0 %> value="remove_border">No border</option>
	</select>
</h1>-->
<div class="inside_edit_exhibit_box">
	<% is_first = true -%>
	<% ajax_action = "'/my9s/edit_element,/my9s/refresh_outline'" -%>
	<% ajax_div_id = "'section_#{section.position},full_window'" -%>
	<% for element in section.exhibit_elements -%>
		<% ajax_params = "'page=#{page.id}&section=#{section.id}&element=#{element.position}&verb='" -%>
		<div class="edit_exhibit_box edit_exhibit_box_no_border">
			<h1>
				<div class="outline_right_controls">
					<%= link_to_function( "[outline]", "showExhibitOutline(#{element.id});", { :title => 'Show Outline' }) %>
					<% #= link_to_function ins_char(), "doAjaxLink(#{ajax_div_id}, #{ajax_action}, #{ajax_params}+'insert');", { :title => 'Insert Element Before' } %>
					<%= link_to_function( up_char(), "doAjaxLink(#{ajax_div_id}, #{ajax_action}, #{ajax_params}+'up');", { :title => 'Move Element Up' }) if element.position > 1 %>
					<%= link_to_function( down_char(), "doAjaxLink(#{ajax_div_id}, #{ajax_action}, #{ajax_params}+'down');", { :title => 'Move Element Down' }) if element.position < section.exhibit_elements.length %>
					<span class="close_link"><%= link_to_function del_char(), "doAjaxLink(#{ajax_div_id}, #{ajax_action}, #{ajax_params}+'delete');", { :title => 'Delete Element' } %></span>
				</div>
				<a id="top-of-<%= element.id %>" name="top-of-<%= element.id %>">
					<span class="edit_exhibit_element_number"><%= element_count %></span>
				</a>
				<% element_count = element_count + 1 -%>
				<select onchange='elementTypeChanged("element_<%= element.id %>", <%= element.id %>, this.options[this.selectedIndex].value);'>
				<option <%= "selected='selected'" if element.exhibit_element_layout_type == 'header' %> value="header">Header</option>
				<option <%= "selected='selected'" if element.exhibit_element_layout_type == 'text' %> value="text">Text</option>
				<option <%= "selected='selected'" if element.exhibit_element_layout_type == 'pic_text' %> value="pic_text">Picture then Text</option>
				<option <%= "selected='selected'" if element.exhibit_element_layout_type == 'text_pic' %> value="text_pic">Text then Picture</option>
				<option <%= "selected='selected'" if element.exhibit_element_layout_type == 'pics' %> value="pics">Row of Pictures</option>
				</select>
				<% if element.exhibit_element_layout_type == 'pics' %>
					<% style = "" -%>
				<% else -%>
					<% style = "display: none;" -%>
				<% end -%>
				<% ill_ajax_action = "'/my9s/insert_illustration'" -%>
				<% ill_ajax_div_id = "'element_#{element.id}'" -%>
				<% illustration_pos = element.exhibit_illustrations.length+1 -%>
				<% ill_ajax_params = "'element_id=#{element.id}&position=-1'" -%>
				<%= link_to_function("[add resource]", "doAjaxLink(#{ill_ajax_div_id}, #{ill_ajax_action}, #{ill_ajax_params});", { :id => "add_image_#{element.id}", :title => 'Append New Illustration To End', :style => style }) %>
			</h1>
			<div id="element_<%= element.id %>" class="inside_edit_exhibit_box element_block">
				<%= render :partial => 'edit_exhibit_element', :locals => { :element => element } %>
			</div> <% # Editing Element inner box %>
		</div> <% # Editing Element outer box %>
	<% end # for each element -%>
	
	<% ajax_params = "'page=#{page.id}&section=#{section.id}&element=#{section.exhibit_elements.length+1}&verb='" -%>
	<% #= link_to_function ins_char(), "doAjaxLink(#{ajax_div_id}, #{ajax_action}, #{ajax_params}+'insert');", { :title => 'Insert Element After' } %>
</div> <% # Editing Section inner box %>
