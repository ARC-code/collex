<%
    # ------------------------------------------------------------------------
    # Copyright 2009 Applied Research in Patacriticism and the University of Virginia
    #
    # Licensed under the Apache License, Version 2.0 (the "License");
    # you may not use this file except in compliance with the License.
    # You may obtain a copy of the License at
    #
    #    http://www.apache.org/licenses/LICENSE-2.0
  
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.
    # ---------------------------------------------------------------------------- -%>
<%= stylesheet_link_tag "exhibits_elements", :media => "all" %>
<% current_page "My&nbsp;9s" -%>
<script language="JavaScript">
	var gIllustrationTypes = <%= ExhibitIllustration.get_illustration_type_array() %>;
	var gCollectedObjects = <%= ExhibitObject.get_collected_object_array(@exhibit.id) %>;
</script>

<script language="JavaScript">
	document.observe('dom:loaded', function() {
		if (window.initOutline) 
			initOutline("full_window");	
		});
</script>

<div id="full_window" class="hidden">
	<div class="bd">
		<div id="full-window-content">
			<%= render :partial => 'exhibit_outline', :locals => { :exhibit => @exhibit, :element_id_selected => -1, :is_editing_border => false } %>
		</div>
	</div>
</div>

<div id="search-main">
	<% if !is_logged_in? -%>
		<%= render :partial => 'my9s_instructions' %>
	<% else -%>
		<div class="tag_minor_nav"> 
			<%= link_to "My9s", { :action => 'index'}, :class => 'nav_link' %><%= link_separator() %>&nbsp;<%= link_to "My objects", { :action => 'results', :view => 'all_collected' }, :class => 'nav_link' %><%= link_separator() %>&nbsp;Editing Exhibit&nbsp;<br />
		</div>
		
		<table class="edit_exhibit_heading"><tr>
			<td valign="top" width="50%">
				<div id="exhibit_palette" class="exhibit_palette">
					<%= render :partial => 'exhibit_palette', :locals => { :exhibit => @exhibit } %>
				</div>
			</td>
			<td valign="top" width="50%">
				<div id="overview_data" class="edit_exhibit_box">
					<%= render :partial => 'overview_data', :locals => { :exhibit => @exhibit, :show_immediately => false } %>
				</div> <% # Exhibit overview data %>
			</td>
		</tr></table>

		<div class="edit_exhibit_links">
			<%= link_to_function "[Show Outline]", "showExhibitOutline(-1,  -1);", :class => 'nav_link' %>
			<% preview_id = @exhibit.visible_url ? (@exhibit.visible_url.length > 0 ? @exhibit.visible_url : @exhibit.id) : @exhibit.id -%>
			<%= link_to_function "[Preview]", "var el = $('overview_visible_url'); window.open('/exhibits/view/'+el.innerHTML+'?page=#{@page}');", { :class => 'nav_link', :target => '_blank' } %>
		</div>
		
		<%= render :partial => '/exhibits/exhibit_page', :locals => { :exhibit => @exhibit, :page_num => @page, :is_edit_mode => true, :top => nil } %>
	<% end # is logged in -%>
</div>
