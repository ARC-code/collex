<%
    # ------------------------------------------------------------------------
    # Copyright 2009 Applied Research in Patacriticism and the University of Virginia
    #
    # Licensed under the Apache License, Version 2.0 (the "License");
    # you may not use this file except in compliance with the License.
    # You may obtain a copy of the License at
    #
    #    http://www.apache.org/licenses/LICENSE-2.0
  
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.
    # ---------------------------------------------------------------------------- -%>
	
<% current_page "My&nbsp;9s" -%>
<div id="search-main">
	<% if !is_logged_in? -%>
		<%= render :partial => 'my9s_instructions' %>
	<% else -%>
		<div class="tag_minor_nav"> 
			<%= link_to "My 9s", { :action => 'index' }, :class => 'nav_link' %><%= link_separator() %>&nbsp;My objects&nbsp;<br />
		</div> 
		
		<table class="results_layout"><tr>
			<tr>
				<td  valign="top">
					<div class="tag_results standard_box">
						<h1>MY TAGS</h1>
						<% selected_tag = "" -%>
						<% selected_tag = params[:tag] if params[:view] == 'tag' -%>
						<div id="tag_cloud_div">
							<%= render :partial => '/tag/cloud', :locals => { :cloud_freq => @cloud_freq, :bucket_size => @bucket_size, :selected_tag => selected_tag, :controller_for_tags => 'my9s'  } %>
						</div>
						<div class="untagged_and_all_links">
							<% if params[:view] == 'untagged' -%>
							<span class="sidebar_tag_link_selected">List All Untagged Objects</span>
							<% else -%>
							<span class="sidebar_tag_link"><%= link_to "List All Untagged Objects", { :action => 'results', :view => 'untagged', :anchor => "top_of_results" }, :class => 'nav_link' %></span>
							<% end -%>
							&nbsp;
							<% if params[:view] == 'all_collected' -%>
							<span class="sidebar_tag_link_selected">List All Collected Objects</span>
							<% else -%>
							<span class="sidebar_tag_link"><%= link_to "List All Collected Objects", { :action => 'results', :view => 'all_collected', :anchor => "top_of_results" }, :class => 'nav_link' %></span>
							<% end -%>
						</div>
					</div>
					<div class="tag_results standard_box">
						<%= render( :partial => 'results/result_count' ) %>    
						<h1><a id="top_of_results"><%= create_total(params[:view], @total_hits, params[:tag]) %></a></h1>
						<%= render( :partial => 'results/pagination', :locals => { :page => @page, :num_pages => @num_pages, :destination_hash => { :action => 'results', :anchor => "top_of_results"} }  ) %>
						
						<div id="all_displayed_results">
							<%= render( :partial => 'results/results', :locals => { :user_id => user.id, :hits => @results } ) %>
						</div>
						
						<%= render( :partial => 'results/pagination', :locals => { :page => @page, :num_pages => @num_pages, :destination_hash => { :action => 'results', :anchor => "top_of_results" } } ) %>
					</div>
				</td>
				<td width="200px" valign="top">
					<div id="exhibited_objects_container" class="standard_box">
						<%= render :partial => 'exhibited_objects', :locals => { :current_user_id => user.id } %>
					</div>
				</td>
			</tr>

		</table>
		</div>
	<% end -%>